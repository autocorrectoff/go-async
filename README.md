how to make batches of async calls using goroutines